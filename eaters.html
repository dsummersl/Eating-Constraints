<!DOCTYPE html>
<html>
	<head>
<!-- scripts and css includes {{{-->
		<link type="text/css" href="css/smoothness/jquery-ui-1.8.16.custom.css" rel="stylesheet" />	
        <link type="text/css" rel="stylesheet" href="css/bootstrap-1.1.1.min.css">
		<link type="text/css" rel="stylesheet" href="test/vizlathon/spec/lib/jspec.css" />
		<link rel="stylesheet" rel="stylesheet" href="css/util.css"/>

		<script type="text/javascript" language="JavaScript" src="js/jquery-1.6.2.min.js"></script>
		<script type="text/javascript" language="JavaScript" src="js/jquery-ui-1.8.16.custom.min.js"></script>

		<script src="test/vizlathon/spec/lib/jspec.js"></script>
		<script src="test/vizlathon/spec/lib/jspec.xhr.js"></script>
		<script src="test/vizlathon/spec/lib/jspec.jquery.js"></script>

		<script type="text/javascript" src="js/d3/d3.js"></script>
		<script type="text/javascript" src="js/d3/d3.layout.js"></script>

		<script type="text/javascript" language="JavaScript" src="js/sprintf.js"></script>
		<script type="text/javascript" language="JavaScript" src="js/util.js"></script>
		<script type="text/javascript" language="JavaScript" src="js/stacktrace.js"></script>
<!--}}}-->
		<script type="text/javascript">
			var debug = true;
			var food = {};
			var uniqueRankCategories;
			$(function() {
				window.onerror = function(msg, file, line) { alert(printStackTrace().join('\n\n')); }
				// test litmus drawing<!--{{{-->
				startupWithData(function() {
					try {
						$.each(d3.keys(clusterDefinitions),function(i,v) {
							$('#colorKey').append($.sprintf('<a class="btn large %s">%s</a>',v,clusterDefinitions[v]));
						});
						$.each(buttonOptions,function(i,bo) {
							options = "";
							if (i == 0) { options = "first active" }
							if (i == buttonOptions.length-1) { options = "last" }
							$('#groupByMenu').append($.sprintf('<li><a id="%s" class="%s" href="#">%s</a></li>',bo.id,options,bo.name));
							$('#'+bo.id).click(function() {
								$('#currentGroupBy').text("Arranged by "+ bo.name);
								return false;
							});
						});
						$('#menuReset').click(function() {
							//$('#currentGroupBy').text("Arranged by "+ buttonOptions[0].name);
							$('#'+ buttonOptions[0].id).click();
							return false;
						});
						$('#currentGroupBy').text("Arranged by "+ buttonOptions[0].name);
						drawTreeMap(food,'#mapresults');
						var eaters = [
							new Eater('Omnivore'),
							new Eater('Vegitarian',['Meat']),
							new Eater('DairyFree',['Dairy']),
							new Eater('FlourFree',['Flour']),

							//new Eater('Vegan',['Meat','Dairy']),
							//new Eater('SugarFree',['Sugar']),
							//new Eater('CornFree',['Corn']),
							//new Eater('SoyFree',['Soy']),
						];
						$.each(eaters,function(i,v) {
							v.setupFoodStore(food.ingredients);
							v.eat(2000); v.eat(2000);
							$('#eaterresults').append($.sprintf('<div class="row"><h3>%s</h3><hr/><div id="%sLitmus" class="litmus"></div></div>',v.description,v.description));
							drawFoodOverviewLitmus(v,'#'+ v.description +'Litmus');
							//viz = drawLitmusForEater(v,'#'+ v.description +'Litmus');
						});
					} catch(e) {
						console.log(printStackTrace({e:e}).join('\n'));
						console.trace();
						alert(e);
					}
				});
				// <!--}}}-->
				// bootstrap menu<!--{{{-->
				$("body").bind("click", function (e) {
					$('a.menu').parent("li").removeClass("open");
				});
				$("a.menu").click(function (e) {
					var $li = $(this).parent("li").toggleClass('open');
					return false;
				}); 
				//<!--}}}-->
				if (debug) { // {{{
					var jspec = JSpec.exec('test/vizlathon/spec/unit/spec.js')
					.run({ fixturePath: 'test/vizlathon/spec/fixtures' });

					if (jspec.stats.failures > 0) {
						var html = '';
						html += '<ul>';
						html += '<li>';
						html += '<div id="jspec-top"><h2 id="jspec-title">JSpec <em>'+ JSpec.version +'</em></h2></div>';
						html += '<div id="jspec"></div>';
						html += '<div id="jspec-bottom"></div>';
						html += '</li>';
						html += '</ul>';
						html += '<br/><br/><br/>';
						html += '<br/><br/><br/>';
						html += '<br/><br/><br/>';
						$('#testresults').append($(html));
						jspec.report();
					}
				} // }}}
			});
		</script>
	</head>
	<body>
		<div class="topbar">
			<div class="fill">
				<div class="container">
					<h3><a href="#">Eating Constraints</a></h3>
					<ul class="nav secondary-nav">
						<li class="menu">
							<a class="menu" href="#">Arrange By...</a>
							<ul id="groupByMenu" class="menu-dropdown">
								<li><a id="menuReset" href="#">Reset</a></li>
								<li class="divider"></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</div>
        <div class="container">
            <h1>Eating Constraints
                <small>How food restrictions affect the diet</small>
            </h1>
            <hr/>
			<div class="row">
				<div class="span8 columns">
					<h3>Motivation</h3>
					<p>
					When it comes to food in the US we've got a whole variety of packaged foods to choose from. But in this 
					sea of food, is it all accessible? What if you are alergic to soy, or wheat? What if you're vegitarian?
					</p>

					<p>
					This page explores the topic of food access. Given a random sampling of foods commonly found in the 
					supermarket, what would various dietary restrictions be able to eat?
					</p>
				</div>
				<div class="span8 columns">
					<h3>Colors</h3>
					<p>
					Foods colored by their nutritional content:
					<p>
					<div id="colorKey"></div>
					<br/>
					This page was designed for the <a href="http://www.stratavizathlon.com/">VizLathon</a>
					contest in August, 2011.
				</div>
				<div class="span16 columns">
					<hr/>
				</div>
			</div>
			<div>
				<div class="row">
					<div class="span11 columns" id="mapbuttons">
						<h3 id="currentGroupBy"></h3>
						<!--TODO cluster by food category (snack, condiment, etc)-->
					</div>
					<div class="span11 columns" id="mapresults">
					</div>
					<div class="span5 columns" id="eaterresults">
					</div>
				</div>
				<!--
				<div class="row">
					<div class="span16 columns">
						<h3>Custom Eater</h3>
						<hr/>
					</div>
				</div>
				-->
			</div>
			<div id="testresults"></div>
        </div>
		<!-- popups and forms -->
		<div style="display:none;" id="startupLoading"><!--{{{-->
			<p>Please wait while data is loaded...</p>
		</div>
		<div style="display:none;" id="eatingFood">
			<p>Please wait while I eat some food...</p>
		</div>
		<div style="display:none;" id='neweaterform'>
			<form>
				Description:
				<input id="eatername" type="text">
				<br/>
				Alergies:
				<select multiple id="alergies"></select>
				<br/>
				Favorites:
				<select multiple id="favorites"></select>
				<br/>
				Submit:
				<input type="submit" href="#" />
				<br/>
			</form>
		</div><!--}}}-->
	</body>
	<!-- vim: set fdm=marker ai: -->
</html>
